# linux percpu 同步机制

## 同步机制
共享数据的同步问题，伴随着整个计算机的发展史，硬件的飞速发展，带动着操作系统和各类软件复杂度日益增长，数据同步问题也变得越来越棘手。   

对于一些微型的系统，即使运行在无操作系统的单片机上，也需要考虑中断与执行主程序链路之间的数据同步问题，这时候的软件设计中的同步方式有很多：锁、volatile关键词、临界区等等。  

操作系统的诞生使得程序分散为更多的执行流，尽管看起来所有进程(线程)并发执行，实际上在同一时刻还是只有一个执行流在工作，数据同步方式和微型系统本质上没有太多区别(从 主程序-中断 双执行流的方式变为多执行流)，只是考虑到系统的优化，细化了各种不同类型的锁、信号量机制。   

随着 SMP(对称多处理器架构) 的发展，在享受处理器更快的执行效率的同时，也为数据同步带来了更大的挑战，因为在 SMP 架构中，程序确实是在并发执行，从单 CPU 只需要考虑调度风险到 SMP 中还需要考虑到多 CPU 中同时执行的风险，而且在单 CPU 下的乱序执行也会在 SMP 架构中带来，从而也衍生了一些新的同步机制，比如：内存屏障、perCPU 机制等等。  


## percpu 机制
最好的同步技术就是


perCPU 是针对 SMP 系统产生的，单 CPU 中该同步机制并不起作用。在各类资料中，


