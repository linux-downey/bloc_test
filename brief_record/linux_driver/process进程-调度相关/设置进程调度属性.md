# 设置进程调度属性
linux 中的进程在创建之初就确定了其调度属性，包括它所属的调度器、优先级，但是这些并不是完全静态的，用户可以通过特定的接口修改它们，这一节来讨论如何对进程的调度属性进行动态地设置，以及这些设置将会引发的调度行为。 

## nice
nice 值是对用户进程优先级的描述，这是 linux 诞生之初就使用的方式，nice 值的范围是 -20~19，值越大优先级越小，这个取值范围着实有点让人摸不着头脑，按照计算机中的编程惯例，要么将负数排除在外，要么将 0 排除在外，因为这样处理起来会显得更优雅、更方便，为什么使用这么一个区间？真相已经淹没在历史的长河中了，而且为了兼容之前的代码，nice 的取值以及用法也就沿袭了下来。  

nice 值只有 40 个取值范围，很明显只对应于用户进程的优先级，在内核的调度行为中，并不使用 nice 值，相对应的使用 static_prio 来替代 nice 作为进程的优先级表示，并且直接提供 nice 与 static_prio 的转换，static_prio 的 100~139 对应 nice 值的 -20~19，其它的对应实时进程的优先级。  

用户程序可以通过 nice 值调整当前进程的优先级，可以通过 man 2 nice 查看 nice 接口：

```c++
int nice(int inc);
```
nice 接收一个 increment 参数，该函数将在当前进程 nice 值的基础上增加 inc 个 nice 值，可以传入负数，表示降低 nice 值，提升进程优先级。  

成功返回新的 nice 值，失败返回 -1，但是有意思的是，正确的返回值也可能是 -1，如果返回 -1，还需要去判断全局变量 error 来确定是正确返回还是错误返回。  

对于普通用户而言，只能加大 nice 值，也就是降低优先级，如果需要减小进程的 nice 值，需要系统权限，或者需要对当前进程的资源限制进行特殊的配置。  

glibc 中的 nice 函数会发起一个系统调用，对应内核中的 nice syscall，这部分的解析见下文。  



## 


