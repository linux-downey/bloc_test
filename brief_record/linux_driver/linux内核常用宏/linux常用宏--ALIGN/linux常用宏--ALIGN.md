# 对齐
在军训或者是集合的时候，教官发出的前几句指令中一定会包含"向左看齐"或者"向右看齐"这一类指令,原本散乱的队伍也在窸窸窣窣的调整中变得井井有条。  

一个经验丰富的仓库管理员总会有那么一些"洁癖"，他们总是会执着于将货物摆放得整整齐齐，而他们也总是骄傲于此。  

"对齐"的概念充斥在各行各业中，就连蜜蜂的蜂巢都是非常标准的正六边形，不禁感慨动物有时候比人更"讲究"。  

如果说对齐有什么好处，那么它最直观的感受就是看起来舒服，教官叫我们站齐，我们就照做，仓库管理员告诉助理你不把货摆好明天就别来上班了，助理也是照做。可是被安排的人心里总会有一些腹诽：又不是参加选美，好看有什么用？  

时光流转，转眼你成了教官、成了仓库主管，你会发现，好看仅仅是对齐这个工作所带来的赠品，而它真正的作用是为后续的操作带来极大的便利。  

队伍调整好之后，只需要几秒就可以在几十上百人中理出那些缺席的，也可以确保在训练的时候每个人都有足够标准的空间，教练也能通过对齐行列间隙看到每个人的状态。而仓库管理也是一样，货物摆放得整齐，方便之后的存取和盘点。  

## 计算机中的对齐
科学总是源于生活而高于生活，我们所熟知的计算机科学中也充斥着各种各样的对齐概念，同时，在计算机中，不仅仅包含空间上的对齐，还包含时间上的对齐。  

### 时间上的对齐
如果你不是一个工作于底层的工程师，可能对时间对齐这个概念是非常陌生的，其实，计算机中时间的对齐我们可以用另一个术语来表示：时间同步。  

单片机、一块单板或者一个我们日常工作所使用的电脑主板，都依赖于时钟系统，计算机中的时钟概念其实和人类对于时间的概念类似，它的作用就是定义一个标准时间轴，所有器件的工作都基于这个标准轴提供的时间而工作。  

毫无争议的是，每个主板上的元器件之间都需要进行数据交互，CPU 与内存、IO、磁盘，各元器件之间组成了一个复杂的以 CPU 为核心的网状拓补图。  

元器件之间需要通信，就需要在时间上进行 "对齐"，基于对齐的概念一共有两种通信方式：同步和异步。  

#### 同步收发
同步就是说，在收发数据时，通信双方都在线，由发送方根据时间刻度发送数据，接收方通过同样的时间刻度解析数据，通常这种形式的收发需要双方做数据确认。   
试想如果双方遵循的时间刻度不一致，比如发送方以一秒发一个单位的数据，而接收方以两秒一个单位的解析数据，那么收发的数据自然有偏差。   

又或者在数据收发时，发送方已经开始发了，而接收方还没准备好，那么就势必造成收方错过了前一部分的数据。  

#### 异步收发
异步收发和同步收发不同的地方在于，通信双方不需要同时在线，而是由发送方根据某个时间刻度发送一个数据包出去，接收方在未来某个时间接收到，按照相同的时间刻度对数据包进行解析。  

事实上，几乎所有的板级通信都需要时钟上的同步，我们也可以理解成一种时间上的"对齐"。  

### 空间上的对齐
事实上，在计算机的世界中，讨论得最多的还是空间上的对齐，从 CPU 内部寄存器、缓存到内存，再到磁盘，每一种不同的介质都有自己不同的特性，也会有一些不同的对齐要求。  

### 为什么需要对齐
CPU 的作用就是执行代码，而缓存、内存和磁盘都是存放 CPU 执行资源的地方，这些资源包含指令和执行指令需要的数据。  

CPU 源源不断地取出指令和数据，对其进行处理，然后在必要的时候写回，理论上来说，既然在内存中以字节为基本单位，那么 CPU 应该就有字节寻址的能力。  

但是，随着内存容量以及程序规模的大幅增长，一个大型程序如果还以字节为单位取资源，这无疑是非常浪费时间的，所以在后续的 CPU 架构中，多采用以 4 字节或者 8 字节为单位进行操作，正好对应了 32(64) 位机器中的寄存器宽度。  

### 什么是对齐


#### 指令和数据的对齐 
CPU 执行指令是有对齐要求的，在不同的平台上会有一定的差异，早期的 ARM 架构中对 "对齐" 是一个硬性要求，如果访问非对齐地址


### 结构体的对齐
### linux内核 ALIGN、PAGE_ALIGN 






